{"version":3,"sources":["utils.js","gui.js","sound.js","colors.js","index.js"],"names":["createNode","n","v","document","createElementNS","p","setAttributeNS","replace","m","o","s","toLowerCase","downloadContent","filename","content","blob","Blob","event","MouseEvent","window","a","createElement","download","href","URL","createObjectURL","dispatchEvent","emptyElement","element","firstChild","removeChild","getParameterByName","name","url","location","regex","RegExp","results","exec","undefined","decodeURIComponent","getQueryStringObject","search","substring","split","map","str","key","value","decodeURI","reduce","prev","curr","Object","assign","getQueryStringObjectFromHash","hash","serializeObject","obj","keys","k","join","controls","id","type","min","max","step","Noise","track","audioContext","AudioContext","webkitAudioContext","createNoise","lastOut","bufferSize","sampleRate","noiseBuffer","createBuffer","output","getChannelData","i","white","Math","random","audioSource","buffer","stopNoise","stop","buildTrack","createBufferSource","gainNode","createGain","connect","destination","setGain","volume","gain","setValueAtTime","currentTime","linearRampToValueAtTime","playNoise","loop","start","play","COLORS","settings","mask","setSettings","options","sound","onload","canvas","context","getContext","width","height","drawImage","getImageData","data","src","setAttributes","attributes","entries","forEach","val","setAttribute","elements","control","label","text","createTextNode","input","innerHTML","appendChild","addEventListener","target","Array","from","querySelectorAll","memo","item","getElementById","params","labelId","SIZE","imageData","ArrayBuffer","length","bufferViewInt8","Uint8ClampedArray","bufferViewInt32","Uint32Array","levelBuffer","levelBufferViewInt8","x","Number","MAX_SAFE_INTEGER","rain","w","offsetWidth","style","y","index","alpha","odds","moveDroplet","set","putImageData","nextLevel","round","rand","horizontalMovement","floor","parseFloat","horizontalMovementOffset","horizontalMovementMax","verticalMovement","verticalMovementOffset","verticalMovementMax","nextColor","color","render","requestAnimationFrame"],"mappings":"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FXsBC,CEWe,AFXnB,EAAU;ACYhCiE,ACAQ,AFXRlE,ECWAkE,ADXAlE,CAAC,GCWG,ADXAE,ECWE,ECAM+E,CDLb,GDNa,CEWK,AFXJ9E,GEWO+E,IAAI,CAACC,MAAL,CFXhB,CAAyB,GEWO,CAAhB,GAAoB,CAAhC,oBFXJ,EAAuDnF,CAAvD,CAAJ;ACYA+C,ACAQ+B,EDAR/B,ICAQ+B,CDAH,EAAE,GCAO,CAACE,CAAD,CAAN,GAAY,CAACP,OAAO,GAAI,OAAOQ,KAAnB,IAA6B,IAAzC;ADNT,AGAH,AFOYR,AFZR,CCFoB,EAcrB,CGPCgC,EFOQhC,CFZH,IAAIrE,CIKD,AJLR,CEYe,EEPJ,CFOO0E,AFZJ7E,CAAd,KEYwB,CAAC+E,CAAD,CAAhB;ADCRlB,AGPA4C,AFOQ5B,AFZJ9E,ECYJ8D,AGPA4C,EHOE,ADZE1G,CAAC,CCYD,AGPA,AFOI8E,AFZFzE,EIKA,IFOQ,CAAC2E,CAAD,CAAN,IAAa,CFZjB,CAAiB,CEYb,GFZJ,EAAuB5E,CAAC,CCW7B,ADX8BE,OAAF,CAAU,QAAV,EAAoB,UAAUC,CAAV,EAAaH,CAAb,EAAgBI,CAAhB,EAAmBC,CAAnB,EAAsB;ACarEsD,AGTW,AFSN,AFZG,CIGZ,CHSIA,IAAI,EAAE,KDZS,ECUhB,IDVsBxD,CAAC,CAACG,WAAF,EAAb;ACaRsD,ADZK,ECYLA,GAAG,ADdwB,CAAvB,CCcC,CAHN,ADTS/D,CAAC,CAACG,CAAD,CAFL;ACeJ6D,AGPJ,AFOQG,AFhBJ,ECgBAH,EGPE0C,AFOEvC,CDAD,EAAE,EAJN,ACIU,CAACgB,KEPG,GAAG,GFOZ,CAAkBC,KEPpBsB,CFOE,GAA2B/B,OEPf,CAAAgC,GFOZ,IEPmB,EAAI;AHQ3B1C,AGPA,AFOC,EDADA,IAAI,AGPA0C,EHOE,CALP,IGFY,CAACC,KAAR,KAAkBJ,QAAQ,CAACI,KAA/B,EAAsC;AHQtC9D,AGPI,AJPJ,ECcAA,KAAK,CGPG0D,CHOD,ADdAzG,CAAP,MIOgB,CAAC6G,KAAT,KAAmB,GAAvB,EAA4B;AHCjC,AGAS1C,AFOR,AFdH,CCPuB,ADAjB,ECqBJ,QCAUmB,QEPKiB,CFOd,GEPQ,AFOa;ADCrBzC,AGPK,AFOD,EDAJA,EAAE,CGTE,CHSA,ECAIM,GEPG,EFOE,CAACgB,WAAV,EAAuB,GDD5B;AAECrB,AGPQI,AFOAC,EDARL,IAAI,ACAIK,EDAF,GCAO,CAACgB,GDFf,IGLeG,IAAN,AFOA,CAAkBA,IAAlB;ADCRvB,AGPK,AFOA,EDALA,GAAG,EAAE,CAAC,GAHP;AAICC,AGPC,AFOA,AFhBE,ECgBHA,EDhBStD,CCgBN,EAAE,GAJN,SDZyB,GAAG,SAAlBA,eAAkB,CAACC,QAAD,EAAWC,OAAX,EAAuB;ACiBlDqD,ADhBA,ECgBAA,IAAI,ADhBEpD,ECgBA,CALP,CDXW,GAAG,IAAIC,IAAJ,CAAS,CAACF,OAAD,CAAT,CAAb;ACiBAkC,AGPA,AFQA,AFjBA,ECgBAA,IGPI0D,AJTEzF,CCgBD,EAAE,CAAC,CCCCwE,AFjBE,GISC,AJTE,CISDkB,GJTKzF,CISd,EFQJ,CAAoBmD,EEREwC,GFQtB,CFjBc,CEiBa,AFjBE,EISA,CAACF,IAA9B,AJTc,EISsB,AJTE;ACUvC,AGAK,AFQAtC,AFjBA,CCZgB,EA4BrB,CCCKA,IERMsC,CFQD,CAACtB,EFjBElE,CISE,GAAGhB,EJVqB,GEkBlC,GERqB,AFQDmE,CEREjD,WFQU,CAACqE,CERpB,CAAuB,KAAvB,CAAb,UFQoB,EAApB;ADAJ3B,ACCIM,AFjBA,ECgBJN,EAAE,ACCEM,EDDA,GCCK,CAACsB,KFjBK,GEiBX,CFnBkC,EEmBjBrB,MDFtB,MCEkC,CAACsB,UAAb,EAAjB;ADAJ5B,AGRI2C,AFSAtC,AFjBA,ECgBJL,EGRI2C,AFSAtC,EDDA,EAAE,CGRE,AFSC,CETA0C,AFSC1B,KDHX,CGNK,EJRc,CIQA,EFSd,CAAkBQ,OAAlB,CAA0BxB,CETA,IFSK,CAACsB,QAAhC;ADAJ1B,AGPQ,AFQJI,AFrBkC,ECoBtCJ,CDpBc,CEqBVI,AFrBJ,CCoBG,EAAE,CAAC,CCCG,CERG2C,AFQFrB,CDJX,KGJmB,EFQd,CERiBxF,AFQF0F,OAAf,CERyB,AFQFvB,CERGjD,WFQS,CAACyE,CERnB,CAAuB,QAAvB,CAAb,AFQJ;ADAJ5B,AGPQ,AFQP,AFjBD,ECgBAA,GAAG,CDhBG9C,CCgBD,ADhBE,GCYR,AGHa6F,AJTF9G,OISS,CJTD,CAACkB,CISG2F,MAAM,CAACE,KJTnB,CAAuB,GAAvB,CISY,AJTtB,CISwC,IAAlB,CAAd;AHQR/C,AGPQ6C,AJTR5F,ECgBA+C,ADhBA/C,CAAC,CAACE,ECgBE,AGPI0F,EHOF,CALP,GGFe,AJTd,CISeG,EJTFtG,GISL,GAAe8F,EJTvB,GIS2B,CAACQ,KAApB;AHQRnE,AGPQgE,AFQR,AFjBA5F,ECgBA4B,ADhBA5B,CAAC,CAACG,EISMyF,CHOH,CDhBL,CCgBO,ECCEjB,AFjBAvE,CISK,CAAC4F,CJTH,CAAC3F,GEiBb,CERQ,AFQS4C,GEROsC,EFQxB,EAAwB,CERI,CAACS,EJTpB,CAAoBrG,GISrB,CJTC,CAAT;ACUD,AGASkG,AFQJ5C,AFjBJjD,CCnBoB,CDmBpBA,CCgBD,ADhBE,CEiBGiD,AFjBF3C,EISMuF,GFQC,CAACjB,GERK,CAACqB,EFQZ,CFjBJ,CAAgBpG,CEiBG,GAAf,CERI,AJTR,CIS0B0F,KAAlB,EAAwB,CAAxB,EAA2B,CAA3B;AHQR5C,AGPQ2C,AFQJrC,AFjBP,CAXM,CC2BHN,EAAE,ACCEM,EDDA,AGPIqC,GFQC,CAACf,GDFX,CGNiB,CAACgB,GFQb,CERI,AFQWV,GERKgB,CFQpB,CAAoBf,KERO,CAACoB,QFQ5B,CAAmC,CAAnC,EERoB,AFQkBhD,CERG,CAArB,EAAwB,CAAxB,EAA2BqC,KAAI,AFQD,CEREQ,AFQDhB,KER/B,EAAuCQ,IFQ3D,CER+D,CAACS,MAA5C,EAAoDG,IAApE;AHQRvD,AGNK,AFODK,EDDJL,ECCIK,CEhBA,CHeA,EAAE,CCCG,CAACsB,KDHX,GCGK,CAAeM,IAAf,CAAoBG,uBAApB,CAA4C/B,KAAK,CAAC2B,MAAN,GAAe,CAA3D,EAA8D1B,YAAY,CAAC6B,WAAb,GAA2B,CAAzF;ADAJlC,ACCII,EDDJJ,ECCII,CDDD,EAAE,CAHN,CCIU,CAACsB,QAAN,CAAeM,IAAf,CAAoBG,uBAApB,CAA4C/B,KAAK,CAAC2B,MAAlD,EAA0D1B,YAAY,CAAC6B,WAAvE;ADAJjC,AGPIyC,AFSH,EDFDzC,EGPIyC,CHOD,EAAE,CAJN,CGHS,CAACa,GAAL,mBAAoBX,OAAO,CAACF,IAA5B;AHQJxC,AGNC,AJZE,ECkBHA,EDlBSxC,ECkBL,EAAE,CALP,ODbsB,GAAG,SAAfA,YAAe,CAAAC,OAAO,EAAI;ACmBnCoB,ACEA,AFpBA,ECkBAA,KAAK,EAAE,ADlBApB,EEoBEyE,KFpBK,CAACxE,GEoBf,GAAqB,IFpBrB,EAA2B;ACY5B,AGCC6E,AFQInB,AFpBA3D,CCxBgB,CGoCpB8E,CHMD,CCEKnB,AFpBA3D,MIYI,CJZG,CAACE,CIYDuB,AFQE,CAACgB,KERG,AFQJ,CERKf,AFQd,GFpBA,CAAoB1B,EIYb,CAAc8E,IJZM,CAAC7E,GIYrB,EAAwBgF,KJZ/B,EIYO,CAAX;AHOA9C,AGNH,AFQO0B,AFpBH,CIdL,CHgCI1B,EAAE,ACEE0B,EDFA,OADL,CCGe,CAACpB,KAAD,CAAV;ADDJL,ACEIS,EDFJT,ECEIS,EDFA,EAAE,OAFP,ACIgB,CAACJ,KAAD,CAAX;ADDJJ,AGNJ,AFQQ8B,AFrBJ,ECmBA9B,EGNEwD,AFQE1B,CDFD,EAAE,CAHN,CDhBQnE,EEqBI,CAACyC,IFrBZ,CIae,AFQJ,CAAP,EERc,SAAhBoD,aAAgB,CAAC7F,OAAD,EAAU8F,UAAV;AHOlBxD,AGPkB,AFSdG,AFrBP,CALM,CCwBHH,ECEIG,CDFD,EAAE,CAJN,CGH4ChB,AFSlC,CAACgC,KETuC,CAACsC,KFS9C,CAAkBrB,CETqB,CAAeoB,EFStD,GAAyB,IAAzB,CETuC,EAC1CE,OAD0C,CAClC;AHOTzD,AGPS,AFSLE,EDFJF,ECEIE,EDFA,EAAE,CALP,ACOU,CAACgB,WAAN,CAAkBkB,KAAlB;ADDJvD,AGRS,AFUR,EDFDA,CChD8B,CAoD9B,GDJK,CGRMD,CHQJ,EGRE;AHEV,AGFU,CHxCW,CAAjB,MGwCa8E,GAAP;AJXN,IAAM9F,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,IAAD,EAAOC,GAAP,EAAe;AIWpC,AFaT,AFvBA,MAAI,CAACA,EEuBE,CFvBP,CIWIL,CJXM,MIWC,CAACkG,YAAR,CAAqB/E,GAArB,EAA0B8E,GAA1B,CADK;AAAA,AFcLrB,AFvBAvE,GIQuC,CAAzB,AFeduE,AFvBAvE,GAAG,CEuBC,EAAEoE,AFvBAlF,MAAM,CAACe,EEsBV,MFtBG,CAAgBX,IAAtB;AIQc,AFgBdiE,AFvBH,CIOL,GFgBQA,IAAI,EAAED;AAFH,GAAP;AEVJ,AFeC,AFzBGvD,CEjCkB,CFiClBA,CEjCG,CE2CD+F,EJVE,GAAG/F,GIUG,CJVC,CAACzB,CIUCuD,MJVN,CAAa,OIUEjB,EJVf,CIUM,CAAa,AJVK,MAAxB,CAAP,GIU0BmF,OAAO,EAAI;AACrC,AJVA,MIUMC,AJVF9F,KIUO,AJVF,GIUKhC,AJVF,IAAIiC,IIUM,CAACf,CJVX,CAAW,SAASW,EIUlB,CAAuB,CJVd,GAAgB,GIUzB,CAAd,eJVY,CAAZ;AIWA,AJXA,MIWMkG,AJVF7F,IIUM,GAAGlC,AJVF,GAAGgC,KIUO,AJVF,CIUGgG,AJVF7F,IAAN,CAAWL,GAAX,CADd,KIWa,CAAwB+F,OAAO,CAACjE,EAAhC,CAAb;AACA,AJVA,MIUMqE,AJVF,CAAC/F,IIUM,GAAGlC,AJVd,EAAc,MIUQ,CAACkB,AJVFkB,SAAP,IIUA,CAAuB,OAAvB,CAAd;AAEAkF,AJXA,EIWAA,IJXI,CAACpF,OAAO,CIWC,AJXA,CIWC+F,AJXF,CAAZ,EAAiB,EIWJ,EAAQJ,GJXG,EAAP,EIWJ,CAAb;AAEA,AJZA,MIYMH,GAAG,AJZFrF,GIYKrC,QAAQ,CAACkB,MJZI,CAACgB,MIYd,CAAuB,AJZF,CAAC,CAAD,CAAP,CAAW9B,EIYzB,CAAZ,IJZ0B,CAAmB,KAAnB,EAA0B,GAA1B,CAAD,CAAzB;AIaAsH,AJZH,CAVM,CIsBHA,GAAG,CAAC9D,EAAJ,mBAAkBiE,OAAO,CAACjE,EAA1B;AACA8D,EAAAA,GAAG,CAACQ,SAAJ,eAAqBL,OAAO,CAAChF,KAA7B;AAEAiF,EAAAA,KAAK,CAACK,WAAN,CAAkBJ,IAAlB;AACAD,EAAAA,KAAK,CAACK,WAAN,CAAkBT,GAAlB;AACAI,AJfG,EIeHA,EJfSxF,GIeJ,CAAC6F,WAAN,CAAkBF,IJfW,CIe7B,EJfgC,SAAvB3F,oBAAuB,GAAM;AIiBtC2F,AJhBA,EIgBAA,KAAK,CAACG,CJhBCpH,MAAM,CAACe,QIgBd,AJhBO,CIgBgB,AJhBAQ,MAAhB,CIgBP,AJhB8BC,EIgBE,OJhBzB,CAAiC,CAAjC,CIgByB1B,CJhBW2B,IIgBN,CJhB9B,CIgBkC,AJhBQ,GAA1C,EACFC,GADE,CACE,UAAAC,GAAG,EAAI;AIgBZ+E,AJhBY,IIgBZA,GAAG,CAACQ,SAAJ,IJfuBvF,GAAG,CAACF,KAAJ,CAAU,CIeZ3B,EJfE,CADX,EIgBc,CAACuH,MAAN,CAAaxF,KAAlC;AACA,AJjBY,QIiBN6D,OAAO,GAAG4B,KAAK,CAACC,IAAN,CAAWvI,QAAQ,CAACwI,gBAAT,CAA0B,OAA1B,CAAX,EACX9F,GADW,CACP;AAAA,AJlBG,QACHE,EIiBEgB,CJlBC,CIkBH,SAAEA,EAAF;AAAA,AJlBG,QACEf,EIiBCA,GJlBH,EIkBH,SAAMA,KAAN;AAAA,iCAAoBe,EAApB,EAAyBf,KAAzB;AAAA,AJhBL,KIeY,EAEXE,MAFW,CAEJ,UAAC0F,IAAD,EAAOC,CJjBN9F,GIiBD,AJjBR,EAAeE,SAAS,CAACD,KAAD,CAAxB;AIiBQ,AJhBX,GAJE,EAKFE,MALE,CAKK,CIeoBG,MAAM,CAACC,EJf1BH,IIemB,AJfpB,CIekCyF,CJf3BxF,GIea,CJfpB,CIewCyF,IAApB,CAAhB;AAAA,AJfJ,KIaQ,EAEuC,EAFvC,CAAhB,CJbwBxF,MAAM,CAACC,MAAP,CAAcH,IAAd,EAAoBC,IAApB,CAAhB;AIgBRlB,AJhBQ,GALL,CIqBHA,AJrBJ,QIqBY,CAACsB,IAAT,GAAgB,4BAAgBqD,OAAhB,CAAhB;AACH,AJhBJ,CAPM,EIiBH;AAQA,SAAOoB,KAAP;AACH,CAxBgB,CAAjB;;AA0BA,AJnBO,IImBDO,AJnBOjF,MImBD,GAAGpD,QAAQ,CAAC2I,UJnBiB,GAAG,CImB7B,CAAwB,OJnB1BvF,GImBE,CAAf,wBJnB4C,GAAM;AIoBlDwE,AJnBI,QImBI,CAACH,AJnBEzG,MAAM,CImBjB,AJnBkBe,CImBD,OJnBN,CAAgBsB,EImBV5B,EJnBN,CAAqBe,IImBR,KJnBb,CAA+B,CAA/B,EAAkCC,KAAlC,CAAwC,GAAxC,EACFC,GADE,CACE,UAAAC,GAAG,EAAI;AIkBI,AJlBJ,SIkBQ0F,MAAM,CAACF,MJjBJxF,GAAG,CAACF,CIiBP,CAAmBhB,GJjBhB,CAAU,GIiBb,AJjBG,CIiBP,AJlBJ;AIkBI,AJlBJ,CIkBpB,GAEA;AJpBoB,QACHmB,GADG;AIqBpB,AJrBoB,IIqBdgG,IJpBgB/F,EIoBV,GAAG,AJrBK,0CIqBpB;AACAK,MAAM,CAACM,IAAP,CAAYoF,MAAZ,EAAoBnB,OAApB,CAA4B,UAAA7E,GAAG,EAAI;AAC/B,AJrBQ,MIqBFqF,KAAK,GAAGjI,QAAQ,CAAC2I,QJrBN/F,GAAT,EAAeE,CIqBT,CAAwBF,GAAxB,CAAd,GJrBgC,CAACC,KAAD,CAAxB;AACH,GAJE,EAKFE,MALE,CAKK,UAACC,IAAD,EAAOC,IAAP;AIoBZ,AJpBY,MIoBRgF,KAAJ,AJpB4B/E,EIoBjB,IJpBuB,CAACC,MAAP,CAAcH,IAAd,EAAoBC,IAApB,CAAhB;AIqBRgF,AJrBQ,GALL,CI0BHA,AJ1BJ,KI0BS,CAACpF,KAAN,GAAc+F,MAAM,CAAChG,GAAD,CAApB;AACH,AJrBJ,CAPM;AI6BN,CALD;AAOA5B,MAAM,CAACoH,gBAAP,CAAwB,YAAxB,EAAsC,UAAAtH,KAAK,EAAI;AAC3C,MAAM4F,OAAO,GAAG,0CAAhB;AACAD,AJvBG,EIuBHA,EJvBSnD,SIuBE,CAACoD,KJvBY,EIuBb,CAAX,AJvB2B,SAAlBpD,eAAkB,CAAAC,GAAG;AIwB9BL,AJxB8B,EIwB9BA,MAAM,CAACM,IAAP,CAAYkD,MJxB0BxD,CIwBtC,EAAqBuE,GJxBuB,CAACjE,GIwB7C,CAA6B,AJxBS,CAAYD,GAAZ,EAAiBb,GAAjB,CIwBTE,AJxB8B,GIwB3B,EAAI,KJxBuBa,CAAC;AIyBxD,AJzBwD,QIyBlDwE,KAAK,GAAGjI,KJzB+CyD,CAAL,EIyBlC,CAACkF,WJzB2CpF,GIyBpD,AJzBuD,CIyB/BX,AJzBgCa,CAAD,CAAb,CIyB1C,CAAd;AJzBwD,GAAtB,EAA0CC,IAA1C,CAA+C,GAA/C,CAAR;AI0B1B,AJ1B0B,CAA3B,OI0BKuE,KAAJ,EAAW;AACPA,MAAAA,KAAK,CAACpF,KAAN,GAAc6D,OAAO,CAAC9D,GAAD,CAArB;AACA,UAAMiG,OAAO,mBAAYjG,GAAZ,CAAb;AACA5C,MAAAA,QAAQ,CAAC2I,cAAT,CAAwBE,OAAxB,EAAiCX,SAAjC,eAAkDxB,OAAO,CAAC9D,GAAD,CAAzD;AACH;AACJ,GAPD;AAQH,CAXD;AAaA,IAAM8D,OAAO,GAAG4B,KAAK,CAACC,IAAN,CAAWvI,QAAQ,CAACwI,gBAAT,CAA0B,OAA1B,CAAX,EACX9F,GADW,CACP;AAAA,MAAEkB,EAAF,SAAEA,EAAF;AAAA,MAAMf,KAAN,SAAMA,KAAN;AAAA,6BAAoBe,EAApB,EAAyBf,KAAzB;AAAA,CADO,EAEXE,MAFW,CAEJ,UAAC0F,IAAD,EAAOC,IAAP;AAAA,SAAgBxF,MAAM,CAACC,MAAP,CAAcsF,IAAd,EAAoBC,IAApB,CAAhB;AAAA,CAFI,EAEuC,EAFvC,CAAhB;AAIAjC,WAAW,CAACC,OAAD,CAAX;AAEA,IAAMoC,IAAI,GAAG,GAAb,EAEA;;AACA,IAAMjC,MAAM,GAAG7G,QAAQ,CAAC2I,cAAT,CAAwB,QAAxB,CAAf;AACA,IAAM7B,OAAO,GAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAhB;AAEAF,MAAM,CAACG,KAAP,GAAe8B,IAAf;AACAjC,MAAM,CAACI,MAAP,GAAgB6B,IAAhB;AAEA,IAAMC,SAAS,GAAGjC,OAAO,CAACK,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B2B,IAA3B,EAAiCA,IAAjC,CAAlB,EAEA;;AACA,IAAM3D,MAAM,GAAG,IAAI6D,WAAJ,CAAgBD,SAAS,CAAC3B,IAAV,CAAe6B,MAA/B,CAAf;AACA,IAAMC,cAAc,GAAG,IAAIC,iBAAJ,CAAsBhE,MAAtB,CAAvB;AACA,IAAMiE,eAAe,GAAG,IAAIC,WAAJ,CAAgBlE,MAAhB,CAAxB,EAEA;;AACA,IAAMmE,WAAW,GAAG,IAAIN,WAAJ,CAAgBD,SAAS,CAAC3B,IAAV,CAAe6B,MAA/B,CAApB;AACA,IAAMM,mBAAmB,GAAG,IAAIJ,iBAAJ,CAAsBG,WAAtB,EAAmC5G,GAAnC,CAAuC,UAAA8G,CAAC;AAAA,SAAIC,MAAM,CAACC,gBAAX;AAAA,CAAxC,CAA5B;;AAEA,SAASC,IAAT,GAAgB;AAEZ,MAAMC,CAAC,GAAG/C,MAAM,CAACgD,WAAjB;AACAhD,EAAAA,MAAM,CAACiD,KAAP,CAAa7C,MAAb,GAAsB2C,CAAtB;;AAEA,OAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,IAApB,EAA0BiB,CAAC,IAAI,CAA/B,EAAkC;AAC9B,SAAK,IAAIP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGV,IAApB,EAA0BU,CAAC,IAAI,CAA/B,EAAkC;AAE9B,UAAMQ,KAAK,GAAID,CAAD,GAAMjB,IAAN,GAAaU,CAA3B;AACA,UAAMS,KAAK,GAAG1D,QAAQ,CAACC,IAAT,CAAcwD,KAAK,GAAG,CAAtB,KAA4B,CAA1C;AAEA,UAAME,IAAI,GAAG,IAAI,GAAJ,IAAW,MAAMD,KAAjB,CAAb;;AACA,UAAIA,KAAK,IAAIjF,IAAI,CAACC,MAAL,KAAgBiF,IAA7B,EAAmC;AAC/BX,QAAAA,mBAAmB,CAACS,KAAD,CAAnB,GAA6B,CAA7B;AACH;;AAEDG,MAAAA,WAAW,CAACH,KAAD,CAAX;AACH;AACJ,GAlBW,CAoBZ;;;AACAjB,EAAAA,SAAS,CAAC3B,IAAV,CAAegD,GAAf,CAAmBlB,cAAnB;AACApC,EAAAA,OAAO,CAACuD,YAAR,CAAqBtB,SAArB,EAAgC,CAAhC,EAAmC,CAAnC;AACH;;AAED,SAASoB,WAAT,CAAqB9C,GAArB,EAA0B;AAEtB,MAAMiD,SAAS,GAAGf,mBAAmB,CAAClC,GAAD,CAAnB,GAA2BrC,IAAI,CAACuF,KAAL,CAAWvF,IAAI,CAACC,MAAL,KAAgB,GAA3B,CAA7C,CAFsB,CAItB;;AACA,MAAMuF,IAAI,GAAGxF,IAAI,CAACuF,KAAL,CAAWvF,IAAI,CAACC,MAAL,KAAgB,GAA3B,CAAb,CALsB,CAOtB;AACA;AACA;AACA;;AACA,MAAMwF,kBAAkB,GAAGpD,GAAG,GAAGrC,IAAI,CAAC0F,KAAL,CAAWC,UAAU,CAACpE,QAAQ,CAACqE,wBAAV,CAAV,GAAgD5F,IAAI,CAACC,MAAL,KAAgB0F,UAAU,CAACpE,QAAQ,CAACsE,qBAAV,CAArF,CAAjC,CAXsB,CActB;AACA;;AACA,MAAMC,gBAAgB,GAAG9F,IAAI,CAAC0F,KAAL,CAAWC,UAAU,CAACpE,QAAQ,CAACwE,sBAAV,CAAV,GAA8C/F,IAAI,CAACC,MAAL,KAAgB0F,UAAU,CAACpE,QAAQ,CAACyE,mBAAV,CAAnF,CAAzB;AAEAzB,EAAAA,mBAAmB,CAACkB,kBAAkB,GAAI3B,IAAI,GAAGgC,gBAA9B,CAAnB,GAAsER,SAAS,IAAIE,IAAI,GAAG,CAAX,CAA/E;AAEA,MAAMS,SAAS,GAAG3E,eAAOC,QAAQ,CAAC2E,KAAhB,EAAuBZ,SAAvB,KAAqC,EAAvD,CApBsB,CAsBtB;;AACAlB,EAAAA,eAAe,CAAC/B,GAAG,GAAGyB,IAAP,CAAf,GACK,OAAO,EAAR,GAAwB;AACvBmC,EAAAA,SAAS,CAAC,CAAD,CAAT,IAAgB,EADjB,GACwB;AACvBA,EAAAA,SAAS,CAAC,CAAD,CAAT,IAAgB,CAFjB,GAEwB;AACxBA,EAAAA,SAAS,CAAC,CAAD,CAJb,CAvBsB,CA2BM;AAC/B;;AAED,SAASE,MAAT,GAAkB;AACdxB,EAAAA,IAAI,GADU,CAGd;;AACAyB,EAAAA,qBAAqB,CAAC;AAAA,WAAMD,MAAM,EAAZ;AAAA,GAAD,CAArB;AACH,EAED;;;AACA,IAAM3E,IAAI,GAAGxG,QAAQ,CAACkB,aAAT,CAAuB,KAAvB,CAAb;;AACAsF,IAAI,CAACI,MAAL,GAAc,YAAY;AAEtB,MAAIC,MAAM,GAAG7G,QAAQ,CAACkB,aAAT,CAAuB,QAAvB,CAAb;AACA,MAAI4F,OAAO,GAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAd;AACAF,EAAAA,MAAM,CAACG,KAAP,GAAeR,IAAI,CAACQ,KAApB;AACAH,EAAAA,MAAM,CAACI,MAAP,GAAgBT,IAAI,CAACS,MAArB;AACAH,EAAAA,OAAO,CAACI,SAAR,CAAkBV,IAAlB,EAAwB,CAAxB,EAA2B,CAA3B;AACAD,EAAAA,QAAQ,CAACC,IAAT,GAAgBM,OAAO,CAACK,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2BX,IAAI,CAACQ,KAAhC,EAAuCR,IAAI,CAACS,MAA5C,EAAoDG,IAApE;AAEH,CATD;;AAUAZ,IAAI,CAACa,GAAL,mBAAoBX,OAAO,CAACF,IAA5B;AAEA2E,MAAM","file":"bitfire.e31bb0bc.js","sourceRoot":"..","sourcesContent":["export const createNode = (n, v) => {\n    n = document.createElementNS(\"http://www.w3.org/2000/svg\", n);\n    for (var p in v)\n        n.setAttributeNS(null, p.replace(/[A-Z]/g, function (m, p, o, s) {\n            return \"-\" + m.toLowerCase();\n        }), v[p]);\n    return n\n};\n\nexport const downloadContent = (filename, content) => {\n    const blob = new Blob([content]);\n    const event = new MouseEvent('click', {\n        'view': window,\n        'bubbles': true,\n        'cancelable': true\n    });\n    const a = document.createElement(\"a\");\n    a.download = filename;\n    a.href = URL.createObjectURL(blob);\n    a.dispatchEvent(event);\n};\n\nexport const emptyElement = element => {\n    while (element.firstChild) {\n        element.removeChild(element.firstChild);\n    }\n    return element;\n};\n\nexport const getParameterByName = (name, url) => {\n    if (!url) {\n        url = window.location.href;\n    }\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n        results = regex.exec(url);\n    if (!results) return undefined;\n    if (!results[2]) return \"\";\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n};\n\nexport const getQueryStringObject = () => {\n    return window.location.search.substring(1).split('&')\n        .map(str => {\n            let [key, value] = str.split('=');\n            return {[key]: decodeURI(value)};\n        })\n        .reduce((prev, curr) => Object.assign(prev, curr));\n};\n\nexport const getQueryStringObjectFromHash = () => {\n    return window.location.hash.substring(1).split('&')\n        .map(str => {\n            let [key, value] = str.split('=');\n            return {[key]: decodeURI(value)};\n        })\n        .reduce((prev, curr) => Object.assign(prev, curr));\n};\n\n\nexport const serializeObject = obj => `#${Object.keys(obj).map(k=>`${k}=${obj[k]}`).join('&')}`;\n","export const controls = [{\n    id: 'mask',\n    type: 'range',\n    min: 0,\n    max: 5,\n    step: 1,\n    value: 0\n}, {\n    id: 'horizontalMovementOffset',\n    type: 'range',\n    min: -2,\n    max: 2,\n    step: 0.1,\n    value: 0\n}, {\n    id: 'horizontalMovementMax',\n    type: 'range',\n    min: 0,\n    max: 10,\n    step: 1,\n    value: 1\n}, {\n    id: 'verticalMovementOffset',\n    type: 'range',\n    min: -100,\n    max: 100,\n    step: 1,\n    value: -1\n}, {\n    id: 'verticalMovementMax',\n    type: 'range',\n    min: -100,\n    max: 100,\n    step: 1,\n    value: 5\n}, {\n    id: 'sound',\n    type: 'range',\n    min: 0,\n    max: 1,\n    step: 1,\n    value: 0\n}, {\n    id: 'color',\n    type: 'range',\n    min: 0,\n    max: 3,\n    step: 1,\n    value: 0\n}];","export const Noise = (function () {\n\n    const track = {};\n    const audioContext = new (window.AudioContext || window.webkitAudioContext);\n\n    function createNoise(track) {\n        var lastOut = 0.0;\n        const bufferSize = 2 * audioContext.sampleRate;\n        const noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);\n        const output = noiseBuffer.getChannelData(0);\n\n        for (let i = 0; i < bufferSize; i++) {\n            var white = Math.random() * 2 - 1;\n            output[i] = (lastOut + (0.02 * white)) / 1.02;\n            lastOut = output[i];\n            output[i] *= 3.5;\n        }\n\n        track.audioSource.buffer = noiseBuffer;\n    }\n\n    function stopNoise() {\n        if (track.audioSource) {\n            track.audioSource.stop();\n        }\n    }\n\n\n    function buildTrack(track) {\n        track.audioSource = audioContext.createBufferSource();\n        track.gainNode = audioContext.createGain();\n        track.audioSource.connect(track.gainNode);\n        track.gainNode.connect(audioContext.destination);\n    }\n\n    function setGain(track) {\n        track.volume = 0.1;\n        track.gainNode.gain.setValueAtTime(0, audioContext.currentTime);\n        track.gainNode.gain.linearRampToValueAtTime(track.volume / 4, audioContext.currentTime / 2);\n        track.gainNode.gain.linearRampToValueAtTime(track.volume, audioContext.currentTime);\n\n    }\n\n    function playNoise() {\n        stopNoise(track);\n        buildTrack(track);\n        createNoise(track);\n        setGain(track);\n        track.audioSource.loop = true;\n        track.audioSource.start();\n    }\n\n    // Expose functions:\n    return {\n        play: playNoise,\n        stop: stopNoise\n    }\n\n}());","// A gray-scale height-map.\nexport const COLORS = [[\n    [255, 255, 255],\n    [240, 240, 240],\n    [217, 217, 217],\n    [189, 189, 189],\n    [150, 150, 150],\n    [115, 115, 115],\n    [82, 82, 82],\n    [37, 37, 37],\n    [0, 0, 0]\n], [\n    [255, 255, 204],\n    [255, 237, 160],\n    [254, 217, 118],\n    [254, 178, 76],\n    [253, 141, 60],\n    [252, 78, 42],\n    [227, 26, 28],\n    [189, 0, 38],\n    [128, 0, 38]\n], [\n    [255, 247, 251],\n    [236, 231, 242],\n    [208, 209, 230],\n    [166, 189, 219],\n    [116, 169, 207],\n    [54, 144, 192],\n    [5, 112, 176],\n    [4, 90, 141],\n    [2, 56, 88]\n], [\n    [247, 252, 245],\n    [229, 245, 224],\n    [199, 233, 192],\n    [161, 217, 155],\n    [116, 196, 118],\n    [65, 171, 93],\n    [35, 139, 69],\n    [0, 109, 44],\n    [0, 68, 27]\n]];","import {getQueryStringObjectFromHash, serializeObject} from './utils.js';\n\n\nimport {controls} from \"./gui.js\";\nimport {Noise} from './sound';\nimport {COLORS} from \"./colors\";\n\nlet settings = {\n    mask: []\n};\n\nconst setSettings = options => {\n    if (options.sound !== settings.sound) {\n        if (settings.sound === \"1\") {\n            Noise.play();\n        } else {\n            Noise.stop();\n        }\n    }\n\n    if (settings.mask !== options.mask) {\n        const mask = document.createElement('img');\n        mask.onload = function () {\n\n            var canvas = document.createElement('canvas');\n            var context = canvas.getContext('2d');\n            canvas.width = mask.width;\n            canvas.height = mask.height;\n            context.drawImage(mask, 0, 0);\n            settings.mask = context.getImageData(0, 0, mask.width, mask.height).data;\n\n        };\n        mask.src = `masks/${options.mask}.gif`;\n\n    }\n\n    settings = Object.assign(settings, options);\n};\n\nconst setAttributes = (element, attributes) => Object.entries(attributes)\n    .forEach(([key, val]) =>\n        element.setAttribute(key, val));\n\nconst elements = controls.map(control => {\n    const label = document.createElement('label');\n    const text = document.createTextNode(control.id);\n    const input = document.createElement('input');\n\n    setAttributes(input, control);\n\n    const val = document.createElement('span');\n    val.id = `label-${control.id}`;\n    val.innerHTML = ` (${control.value})`;\n\n    label.appendChild(text);\n    label.appendChild(val);\n    label.appendChild(input);\n\n    input.addEventListener('input', event => {\n        val.innerHTML = ` (${event.target.value})`;\n        const options = Array.from(document.querySelectorAll('input'))\n            .map(({id, value}) => ({[id]: value}))\n            .reduce((memo, item) => Object.assign(memo, item), {});\n        location.hash = serializeObject(options);\n    });\n\n    return label;\n});\n\nconst target = document.getElementById('controls');\nelements.forEach(element => target.appendChild(element));\n\n// const search = window.location.search;\nconst params = getQueryStringObjectFromHash();\nObject.keys(params).forEach(key => {\n    const input = document.getElementById(key);\n    if (input) {\n        input.value = params[key];\n    }\n});\n\nwindow.addEventListener(\"hashchange\", event => {\n    const options = getQueryStringObjectFromHash();\n    setSettings(options);\n    Object.keys(options).forEach(key => {\n        const input = document.getElementById(key);\n        if (input) {\n            input.value = options[key];\n            const labelId = `label-${key}`;\n            document.getElementById(labelId).innerHTML = ` (${options[key]})`;\n        }\n    });\n});\n\nconst options = Array.from(document.querySelectorAll('input'))\n    .map(({id, value}) => ({[id]: value}))\n    .reduce((memo, item) => Object.assign(memo, item), {});\n\nsetSettings(options);\n\nconst SIZE = 256;\n\n// Setup the canvas.\nconst canvas = document.getElementById('canvas');\nconst context = canvas.getContext('2d');\n\ncanvas.width = SIZE;\ncanvas.height = SIZE;\n\nconst imageData = context.getImageData(0, 0, SIZE, SIZE);\n\n// One buffer to hold the color data for each pixel.\nconst buffer = new ArrayBuffer(imageData.data.length);\nconst bufferViewInt8 = new Uint8ClampedArray(buffer);\nconst bufferViewInt32 = new Uint32Array(buffer);\n\n// One buffer to hold the height map level for each pixel.\nconst levelBuffer = new ArrayBuffer(imageData.data.length);\nconst levelBufferViewInt8 = new Uint8ClampedArray(levelBuffer).map(x => Number.MAX_SAFE_INTEGER);\n\nfunction rain() {\n\n    const w = canvas.offsetWidth;\n    canvas.style.height = w;\n\n    for (let y = 0; y < SIZE; y += 1) {\n        for (let x = 0; x < SIZE; x += 1) {\n\n            const index = (y) * SIZE + x;\n            const alpha = settings.mask[index * 4] || 0;\n\n            const odds = 1 / 255 * (255 - alpha);\n            if (alpha && Math.random() > odds) {\n                levelBufferViewInt8[index] = 0;\n            }\n\n            moveDroplet(index);\n        }\n    }\n\n    // Update the canvas with the new pixel values.\n    imageData.data.set(bufferViewInt8);\n    context.putImageData(imageData, 0, 0);\n}\n\nfunction moveDroplet(src) {\n\n    const nextLevel = levelBufferViewInt8[src] + Math.round(Math.random() * 1.3);\n\n    // Generate a 0, 1 or 2.\n    const rand = Math.round(Math.random() * 2.0);\n\n    // Add horizontal movement to create a wind effect.\n    // const horizontalMovement = Math.random() > 0.8\n    //     ? src - rand + Math.floor((settings.wind * 8 - 3))\n    //     : src;\n    const horizontalMovement = src + Math.floor(parseFloat(settings.horizontalMovementOffset) + Math.random() * parseFloat(settings.horizontalMovementMax));\n\n\n    // Every 1 in 5 the rain will move up-wards and create the\n    // street splash effect.\n    const verticalMovement = Math.floor(parseFloat(settings.verticalMovementOffset) + Math.random() * parseFloat(settings.verticalMovementMax));\n\n    levelBufferViewInt8[horizontalMovement + (SIZE * verticalMovement)] = nextLevel - (rand & 1);\n\n    const nextColor = COLORS[settings.color][nextLevel] || 11;\n\n    // Set the new pixel value.\n    bufferViewInt32[src - SIZE] =\n        (255 << 24) |           // Alpha\n        (nextColor[2] << 16) |  // Blue\n        (nextColor[1] << 8) |   // Green\n        nextColor[0];           // Red\n}\n\nfunction render() {\n    rain();\n\n    // Go again!\n    requestAnimationFrame(() => render());\n}\n\n// Go!\nconst mask = document.createElement('img');\nmask.onload = function () {\n\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    canvas.width = mask.width;\n    canvas.height = mask.height;\n    context.drawImage(mask, 0, 0);\n    settings.mask = context.getImageData(0, 0, mask.width, mask.height).data;\n\n};\nmask.src = `masks/${options.mask}.gif`;\n\nrender();"]}